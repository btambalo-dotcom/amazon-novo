{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center">
  <h1>Corridas</h1>
  <div>
    <a class="btn btn-secondary me-2" href="{{ url_for('rides.calendar') }}">Calendário</a>
    <a class="btn btn-primary" href="{{ url_for('rides.nova') }}">Nova corrida</a>
  </div>
</div>
<table class="table table-striped mt-3 align-middle">
  <thead><tr><th>Data</th><th>Início</th><th>Fim</th><th>Horas</th><th>Estação</th><th>Total</th><th style="width:160px"></th></tr></thead>
  <tbody>
  {% for r, s in rides %}
    <tr>
      <td>{{ r.inicio.strftime('%d/%m/%Y') }}</td>
      <td>{{ r.inicio.strftime('%H:%M') }}</td>
      <td>{{ r.fim.strftime('%H:%M') }}</td>
      <td>{{ '%.2f'|format(r.horas) }}</td>
      <td>{{ s.nome if s else '—' }}</td>
      <td>${{ '%.2f'|format(r.valor + r.gorjeta) }}</td>
      <td class="text-end">
        <a class="btn btn-sm btn-outline-primary" href="{{ url_for('rides.view', ride_id=r.id) }}">Abrir</a>
        <form method="post" action="{{ url_for('rides.delete', ride_id=r.id) }}" class="d-inline" onsubmit="return confirm('Excluir esta corrida? As despesas vinculadas também serão apagadas.');">
          <button class="btn btn-sm btn-outline-danger">Excluir</button>
        </form>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
